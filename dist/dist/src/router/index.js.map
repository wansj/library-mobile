{"version":3,"sources":["../../../src/router/index.js"],"names":["_regeneratorRuntime","_asyncToGenerator","_this","Vue","Router","isLoged","apolloClient","UpdateLoadingStatusMutation","use","router","mode","routes","path","component","then","m","default","meta","requireAuth","children","props","route","id","params","bookId","query","userId","skip","limit","field","value","category","beforeEach","_ref","mark","_callee","to","from","next","loged","wrap","_callee$","_context","prev","mutate","mutation","variables","loading","matched","some","record","sent","stop","_x","_x2","_x3","apply","arguments","afterEach"],"mappings":"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","file":"index.js","sourcesContent":["import _regeneratorRuntime from 'babel-runtime/regenerator';\nimport _asyncToGenerator from 'babel-runtime/helpers/asyncToGenerator';\n\nvar _this = this;\n\nimport Vue from 'vue';\nimport Router from 'vue-router';\nimport { isLoged } from '../utils';\nimport apolloClient from '../ApolloClient';\nimport { UpdateLoadingStatusMutation } from '../store/LoadingStatus';\n\nVue.use(Router);\n\nvar router = new Router({\n  mode: 'history',\n  routes: [{\n    path: '/signin',\n    component: function component() {\n      return import('@/components/SignIn.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }, {\n    path: '/reset-password',\n    component: function component() {\n      return import('@/components/Resetpassword.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }, {\n    path: '/signup',\n    component: function component() {\n      return import('@/components/SignUp.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }, {\n    path: '/',\n    component: function component() {\n      return import('@/components/MainLayout.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    meta: { requireAuth: true },\n    children: [{\n      path: '',\n      component: function component() {\n        return import('@/components/Home.vue').then(function (m) {\n          return m.default;\n        });\n      }\n    }, {\n      path: 'categories',\n      component: function component() {\n        return import('@/components/CategoryLayout.vue').then(function (m) {\n          return m.default;\n        });\n      }\n    }, {\n      path: 'me',\n      component: function component() {\n        return import('@/components/Me.vue').then(function (m) {\n          return m.default;\n        });\n      }\n    }]\n  }, {\n    path: '/books',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/BookLayout.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    children: [{\n      path: ':id',\n      component: function component() {\n        return import('@/components/BookDetails.vue').then(function (m) {\n          return m.default;\n        });\n      },\n      props: function props(route) {\n        return { id: route.params.id };\n      }\n    }, {\n      path: 'comments/view',\n      component: function component() {\n        return import('@/components/CommentsView.vue').then(function (m) {\n          return m.default;\n        });\n      },\n      props: function props(route) {\n        return { bookId: route.query.bookId, userId: route.query.userId };\n      }\n    }, {\n      path: 'comments/:id',\n      component: function component() {\n        return import('@/components/CommentsDetail.vue').then(function (m) {\n          return m.default;\n        });\n      },\n      props: function props(route) {\n        return { id: route.params.id, skip: route.query.skip, limit: route.query.limit, bookId: route.query.bookId };\n      }\n    }, {\n      path: 'cart/view',\n      component: function component() {\n        return import('@/components/BookCart.vue').then(function (m) {\n          return m.default;\n        });\n      }\n    }]\n  }, {\n    path: '/books/:id/comments/post',\n    component: function component() {\n      return import('@/components/PostComment.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    props: function props(route) {\n      return { bookId: route.params.id, userId: route.query.userId };\n    }\n  }, {\n    path: '/user',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/UserDetails.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }, {\n    path: '/editUser',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/EditUser.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    props: function props(route) {\n      return { field: route.query.field, value: route.query.value, id: route.query.id };\n    }\n  }, {\n    path: '/history',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/BorrowHistory.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    props: function props(route) {\n      return { userId: route.query.userId };\n    }\n  }, {\n    path: '/collection',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/UserCollection.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    props: function props(route) {\n      return { userId: route.query.userId };\n    }\n  }, {\n    path: '/search',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/SearchPage.vue').then(function (m) {\n        return m.default;\n      });\n    },\n    props: function props(route) {\n      return { category: route.query.category };\n    }\n  }, {\n    path: '/borrow-plan',\n    meta: { requireAuth: true },\n    component: function component() {\n      return import('@/components/BorrowPlan.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }, {\n    path: '/friends',\n    component: function component() {\n      return import('@/components/Friends.vue').then(function (m) {\n        return m.default;\n      });\n    }\n  }]\n});\nrouter.beforeEach(function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(to, from, next) {\n    var loged;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            apolloClient.mutate({\n              mutation: UpdateLoadingStatusMutation,\n              variables: { loading: true }\n            });\n\n            if (!to.matched.some(function (record) {\n              return record.meta.requireAuth;\n            })) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 4;\n            return isLoged();\n\n          case 4:\n            loged = _context.sent;\n\n            // console.log(token)\n            if (!loged) {\n              next({\n                path: '/signin'\n              });\n            } else {\n              next();\n            }\n            _context.next = 9;\n            break;\n\n          case 8:\n            next();\n\n          case 9:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nrouter.afterEach(function (to) {\n  apolloClient.mutate({\n    mutation: UpdateLoadingStatusMutation,\n    variables: { loading: false }\n  });\n});\nexport default router;\n//# sourceMappingURL=index.js.map"]}